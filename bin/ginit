#!/bin/bash

usage() {
    echo "Usage: ginit [-p | --private] lang repo" 1>&2
    exit 1
}

if [[ $1 = "-p" ]] || [[ $1 = "--private" ]]; then
    opt="-p"
    lang=$2
    repo=$3
elif [[ $3 = "-p" ]] || [[ $3 = "--private" ]]; then
    opt="-p"
    lang=$1
    repo=$2
elif [[ $# -eq 2 ]]; then
    lang=$1
    repo=$2
else
    usage
fi

if ! type "hub" &> /dev/null; then
    echo "hub command is not installed" 1>&2
    exit 1
fi

if [[ -z $1 ]]; then
    echo "Specify language type" 1>&2
    usage
fi

if [[ -z $2 ]]; then
    echo "Specify new repository name" 1>&2
    usage
fi

if [[ $lang = "python" ]]; then
    template="https://github.com/chlorochrule/ginit-python"
else
    echo "There is no $lang template"
fi

mkdir $repo; wait
git clone $template $repo; wait
cd $repo; wait
bash .ginitrc $repo; wait
rm -rf .git; wait
rm .ginitrc; wait
git init; wait
git add .; wait
git commit -m "Initial commit"; wait
hub create $opt $repo; wait
git push origin master; wait

